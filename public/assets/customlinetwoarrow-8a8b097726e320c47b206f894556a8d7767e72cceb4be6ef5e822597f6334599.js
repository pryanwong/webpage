var customlinetwoarrow=function(){};customlinetwoarrow.setLinePositions=function(e){for(var o=e.target,t=(o.get("type"),o.get("objId")),r=_curX-e.e.clientX,n=_curY-e.e.clientY,c=0;c<canvas.getObjects().length;c++){var i=canvas.getObjects()[c];"carrowtwo"==i.type&&i.get("belongsTo")==t&&(_c2Top=i.getTop(),_c2Left=i.getLeft(),i.set({left:i.left-r,top:i.top-n}),i.setCoords(),i.line&&i.line.set({x1:i.left,y1:i.top}),i.line.setCoords()),"carrow"==i.type&&i.get("belongsTo")==t&&(_c1Top=i.getTop(),_c1Left=i.getLeft(),i.set({left:i.left-r,top:i.top-n}),i.setCoords(),i.line&&i.line.set({x2:i.left,y2:i.top}),i.line.setCoords())}_curX=e.e.clientX,_curY=e.e.clientY},customlinetwoarrow.setLineCirclePositionsBoundary=function(e){var o=e.target;o.get("type"),o.get("objId"),_curX-e.e.clientX,_curY-e.e.clientY;_circleOne=o.carrow,_circleTwo=o.carrowtwo,_circleTwo&&_circleTwo.set({left:_c2Left,top:_c2Top}),_circleTwo.setCoords(),_circleTwo.line&&_circleTwo.line.set({x2:_circleTwo.left,y2:_circleTwo.top}),_circleTwo.line.setCoords(),_circleOne.line&&_circleOne.set({left:_c1Left,top:_c1Top}),_circleOne.setCoords(),_circleOne.line&&_circleOne.line.set({x1:_circleOne.left,y1:_circleOne.top}),_circleOne.line.setCoords(),o&&o.set({x1:_circleOne.left,y1:_circleOne.top,x2:_circleTwo.left,y2:_circleTwo.top}),o.setCoords(),_curX=e.e.clientX,_curY=e.e.clientY},customlinetwoarrow.makeLineTwoArrow=function(e,o){return log.info("Entering makeLine"),log.debug("Coords are: ",e),line=new fabric.Customlinetwoarrow(e,{x1:e[0],y1:e[1],x2:e[2],y2:e[3],fill:"red",stroke:"red",strokeWidth:5,selectable:!0,objId:o,perPixelTargetFind:!0}),line.hasControls=!1,log.info("Leaving makeLine"),line},customlinetwoarrow.lineArrowTwoDown=function(e){log.info("Entering lineDown"),activeObjectVal&&(activeObject=!0),""!=handler&&document.removeEventListener("contextmenu",handler),3==e.e.which&&(handler=function(e){if(0==contextmenuon&&1==activeObject){e.preventDefault();var o=["Delete","Change Color","Send Backward","Send To Back","Bring Forward","Bring To Front"];angular.element(document.querySelector('[ng-controller="ModalProductConfigController as mpc"]')).scope().mpc.deleteAction=function(){if(activeObjectVal.type)if("customlinetwoarrow"==activeObjectVal.type)canvas.remove(activeObjectVal.carrowtwo),canvas.remove(activeObjectVal.carrow),canvas.remove(activeObjectVal);else if(activeObjectVal.hasOwnProperty("belongsTo")){for(var e=canvas.getObjects(),o=activeObjectVal.get("belongsTo"),t=!1,r=0;!t&&r<e.length;)"customlinetwoarrow"==e[r].type&&e[r].objId==o&&(t=!0),r+=1;t&&(r-=1,canvas.remove(e[r].carrowtwo),canvas.remove(e[r].carrow),canvas.remove(e[r])),canvas.renderAll()}$("#contextMenu").remove(),contextmenuon=!1,activeObject=!1},menus(o,e),contextmenuon=!0}},document.addEventListener("contextmenu",handler,!1)),log.info("Leaving lineDown")},customlinetwoarrow.makeArrowTwo=function(e){log.info("Entering makeArrowTwo");var o=new fabric.Carrowtwo({left:e.get("x1")-2.5,top:e.get("y1")-2.5,originX:"center",originY:"center",hasBorders:!1,hasControls:!1,lockScalingX:!0,lockScalingY:!0,lockRotation:!0,pointType:"arrow_start",angle:-45,width:20,height:20,fill:"#000"});o.setBelongsTo(e.objId);var t=new fabric.Carrow({left:e.get("x2"),top:e.get("y2"),originX:"center",originY:"center",hasBorders:!1,hasControls:!1,lockScalingX:!0,lockScalingY:!0,lockRotation:!0,pointType:"arrow_start",angle:135,width:20,height:20,fill:"#000"});t.setBelongsTo(e.objId),o.hasBorders=o.hasControls=!1,t.hasBorders=t.hasControls=!1,o.line=e,t.line=e,e.carrowtwo=o,e.carrow=t;var r=new Array(o,t);return log.info("Leaving makeCircle"),r},customlinetwoarrow.lineDrop=function(e,o){log.debug("In line.png section"),objectName="customlinetwoarrow";var t=e.layerX,r=e.layerY,n=t+25,i=r+25;objId=o;var l=customlinetwoarrow.makeLineTwoArrow([t,r,n,i],o);l.hasControls=!1,itemId+=1,l.id=itemId,l.objId=itemId,canvas.add(l),c[o]=customlinetwoarrow.makeArrowTwo(l),l.carrowtwo=c[o][0],l.carrow=c[o][1],canvas.add(c[o][0],c[o][1]),canvas.renderAll(),l.on("mousedown",function(e,o){customlinetwoarrow.lineArrowTwoDown(e,o)})};
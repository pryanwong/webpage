/*!jslint vars: false, browser: true, nomen: true, regexp: true */
/*!global jQuery */
/*!
* jQuery Password Strength plugin for Twitter Bootstrap
*
* Copyright (c) 2008-2013 Tane Piper
* Copyright (c) 2013 Alejandro Blanco
* Dual licensed under the MIT and GPL licenses.
*
*/
!function(r){"use strict";var s={errors:[],minChar:6,errorMessages:{password_to_short:"The Password is too short",same_as_username:"Your password cannot be the same as your username",word_email:"Your password should not be an email"},scores:[-93,14,17,26,40,50],verdicts:["Weak","Normal","Medium","Strong","Very Strong"],showVerdicts:!0,raisePower:1.4,usernameField:"#username",onLoad:void 0,onKeyUp:void 0,viewports:{progress:void 0,verdict:void 0,errors:void 0},ruleScores:{wordNotEmail:-100,wordLength:-100,wordSimilarToUsername:-100,wordLowercase:1,wordUppercase:3,wordOneNumber:3,wordThreeNumbers:5,wordOneSpecialChar:3,wordTwoSpecialChar:5,wordUpperLowerCombo:2,wordLetterNumberCombo:2,wordLetterNumberCharCombo:2},rules:{wordNotEmail:!0,wordLength:!0,wordSimilarToUsername:!0,wordLowercase:!0,wordUppercase:!0,wordOneNumber:!0,wordThreeNumbers:!0,wordOneSpecialChar:!0,wordTwoSpecialChar:!0,wordUpperLowerCombo:!0,wordLetterNumberCombo:!0,wordLetterNumberCharCombo:!0},validationRules:{wordNotEmail:function(r,s,e){var o=s.match(/^([\w\!\#$\%\&\'\*\+\-\/\=\?\^\`{\|\}\~]+\.)*[\w\!\#$\%\&\'\*\+\-\/\=\?\^\`{\|\}\~]+@((((([a-z0-9]{1}[a-z0-9\-]{0,62}[a-z0-9]{1})|[a-z])\.)+[a-z]{2,6})|(\d{1,3}\.){3}\d{1,3}(\:\d{1,5})?)$/i);return o&&r.errors.push(r.errorMessages.word_email),o&&e},wordLength:function(r,s,e){var o=s.length,a=Math.pow(o,r.raisePower);return o<r.minChar&&(a+=e,r.errors.push(r.errorMessages.password_to_short)),a},wordSimilarToUsername:function(s,e,o){var a=r(s.usernameField).val();return a&&e.toLowerCase().match(a.toLowerCase())?(s.errors.push(s.errorMessages.same_as_username),o):!0},wordLowercase:function(r,s,e){return s.match(/[a-z]/)&&e},wordUppercase:function(r,s,e){return s.match(/[A-Z]/)&&e},wordOneNumber:function(r,s,e){return s.match(/\d+/)&&e},wordThreeNumbers:function(r,s,e){return s.match(/(.*[0-9].*[0-9].*[0-9])/)&&e},wordOneSpecialChar:function(r,s,e){return s.match(/.[!,@,#,$,%,\^,&,*,?,_,~]/)&&e},wordTwoSpecialChar:function(r,s,e){return s.match(/(.*[!,@,#,$,%,\^,&,*,?,_,~].*[!,@,#,$,%,\^,&,*,?,_,~])/)&&e},wordUpperLowerCombo:function(r,s,e){return s.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&e},wordLetterNumberCombo:function(r,s,e){return s.match(/([a-zA-Z])/)&&s.match(/([0-9])/)&&e},wordLetterNumberCharCombo:function(r,s,e){return s.match(/([a-zA-Z0-9].*[!,@,#,$,%,\^,&,*,?,_,~])|([!,@,#,$,%,\^,&,*,?,_,~].*[a-zA-Z0-9])/)&&e}}},e=function(s,e){var o,a=s.data("pwstrength"),t=a.progressbar;a.showVerdicts&&(a.viewports.verdict?o=r(a.viewports.verdict).find("#password-verdict"):(o=s.parent().find("#password-verdict"),0===o.length&&(o=r('<div id="password-verdict" class="input-group-addon"></div>'),o.insertAfter(r(el))))),e<a.scores[0]?(t.addClass("progress-danger").removeClass("progress-warning").removeClass("progress-success"),t.find("#bar").css("width","0%").addClass("progress-bar-danger").removeClass("progress-bar-warning").removeClass("progress-bar-success"),a.showVerdicts&&o.text(a.verdicts[0])):e>=a.scores[0]&&e<a.scores[1]?(t.addClass("progress-danger").removeClass("progress-warning").removeClass("progress-success"),t.find("#bar").css("width","10%").addClass("progress-bar-danger").removeClass("progress-bar-warning").removeClass("progress-bar-success"),a.showVerdicts&&o.text(a.verdicts[1])):e>=a.scores[1]&&e<a.scores[2]?(t.addClass("progress-warning").removeClass("progress-danger").removeClass("progress-success"),t.find("#bar").css("width","25%").addClass("progress-bar-warning").removeClass("progress-bar-danger").removeClass("progress-bar-success"),a.showVerdicts&&o.text(a.verdicts[2])):e>=a.scores[2]&&e<a.scores[3]?(t.addClass("progress-warning").removeClass("progress-danger").removeClass("progress-success"),t.find("#bar").css("width","50%").addClass("progress-bar-warning").removeClass("progress-bar-danger").removeClass("progress-bar-success"),a.showVerdicts&&o.text(a.verdicts[2])):e>=a.scores[4]&&e<a.scores[5]?(t.addClass("progress-warning").removeClass("progress-danger").removeClass("progress-success"),t.find("#bar").css("width","75%").addClass("progress-bar-warning").removeClass("progress-bar-danger").removeClass("progress-bar-success"),a.showVerdicts&&o.text(a.verdicts[3])):e>=a.scores[5]&&(t.addClass("progress-success").removeClass("progress-warning").removeClass("progress-danger"),t.find("#bar").css("width","100%").addClass("progress-bar-success").removeClass("progress-bar-warning").removeClass("progress-bar-danger"),a.showVerdicts&&o.text(a.verdicts[4]))},o=function(s){var o=s.val(),a=0,t=s.data("pwstrength");return r.each(t.rules,function(r,s){if(s===!0){var e=t.ruleScores[r],n=t.validationRules[r](t,o,e);n&&(a+=n)}}),console.log("Total Score: ",a),e(s,a),a},a=function(){return'<div class="progress"><div id="bar" class="progress-bar"></div></div>'},t={init:function(e){var t=this,n=r.extend(s,e);return this.each(function(s,e){var d,i,c=r(e);c.data("pwstrength",n),c.on("keyup",function(s){var e=c.data("pwstrength");e.errors=[],o.call(t,c),r.isFunction(e.onKeyUp)&&e.onKeyUp(s)}),d=r(a()),n.viewports.progress?r(n.viewports.progress).append(d):d.insertAfter(r("#passwordholder")),d.find("#bar").css("width","0%"),c.data("pwstrength").progressbar=d,n.showVerdicts&&(i=r('<div id="password-verdict" class="input-group-addon">'+n.verdicts[0]+"</div>"),n.viewports.verdict?r(n.viewports.verdict).append(i):i.insertAfter(c)),r.isFunction(n.onLoad)&&n.onLoad()})},destroy:function(){this.each(function(s,e){var o=r(e);o.parent().find("span.password-verdict").remove(),o.parent().find("div.progress").remove(),o.parent().parent().find("div.error-list").remove(),o.removeData("pwstrength")})},forceUpdate:function(){var s=this;this.each(function(e,a){var t=r(a),n=t.data("pwstrength");n.errors=[],o.call(s,t)})},outputErrorList:function(){this.each(function(s,e){var o,a='<div class="error-list">',t=r(e),n=t.data("pwstrength").errors,d=t.data("pwstrength").viewports;t.parent().parent().find("div.error-list").remove(),n.length>0&&(r.each(n,function(r,s){a+="<span>"+s+"</span>"}),a+="</div>",d.errors?r(d.errors).html(a):(a=r(a),o=t.parent().find("div#password-verdict"),o.length>0&&(e=o),a.insertAfter(r("#passwordholder"))))})},addRule:function(s,e,o,a){this.each(function(t,n){var d=r(n).data("pwstrength");d.rules[s]=a,d.ruleScores[s]=o,d.validationRules[s]=e})},changeScore:function(s,e){this.each(function(o,a){r(a).data("pwstrength").ruleScores[s]=e})},ruleActive:function(s,e){this.each(function(o,a){r(a).data("pwstrength").rules[s]=e})}};r.fn.pwstrength=function(s){var e;return t[s]?e=t[s].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof s&&s?r.error("Method "+s+" does not exist on jQuery.pwstrength"):e=t.init.apply(this,arguments),e}}(jQuery);
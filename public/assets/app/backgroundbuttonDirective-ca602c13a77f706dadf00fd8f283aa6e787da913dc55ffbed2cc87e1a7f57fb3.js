angular.module("app").service("backgroundAService",function(){this.backgroundImg="",this.imageSrc=""}),angular.module("app").directive("backgroundbuttonDirective",["backgroundAService",function(){return{restrict:"E",replace:!0,scope:{openModal:"&",background:"@"},template:'<button id="backgroundButtonText" class="btn btn-default" background="" >{{backgroundText}}</button>',link:function(a,n,o){function c(){$("#saveMessage").text("Changes Made, Save Pending..."),$("#lefile").attr("value",""),$("#lefile").val(""),$("#backgroundButtonText").attr("background",""),canvas.setBackgroundImage(0,canvas.renderAll.bind(canvas)),onSave()}a.backgroundText="Background",a.$watch("backgroundText",function(){console.log("watch backround attr:",a.backgroundText,":",a.background)}),a.$watch("background",function(){console.log("watch backround attr:",a.backgroundText,":",a.background)}),runBackground=function(){console.log("In Run Background"),$("#lefile").value="",$("#backgroundfile").val("");var a=$("#bar");return a.addClass("progress-success"),a.text("0%"),a.attr("value","0"),!1},$(window).load(function(){backgroundImageVal="",console.log("backgroundImg: ",canvas.backgroundImage),null!==canvas.backgroundImage&&(backgroundimg=canvas.backgroundImage,console.log("drawing_scripts: ",backgroundimg),null!==backgroundimg.src&&(backgroundImageVal=canvas.backgroundImage.src,a.$apply(function(){a.backgroundText="Remove Background"}))),$("#backgroundButtonText").attr("background",backgroundImageVal),background=backgroundImageVal,console.log("In link background val: ",n.attr("background"))}),n.bind("click",function(){return console.log("background val: ",n.attr("background")),""==n.attr("background")||null==n.attr("background")?(runBackground(),a.openModal(),a.$apply(function(){a.backgroundText="Remove Background"}),!1):(c(),a.background="",a.$apply(function(){a.backgroundText="Background"}),o.$set("background",""),!1)})}}}]);
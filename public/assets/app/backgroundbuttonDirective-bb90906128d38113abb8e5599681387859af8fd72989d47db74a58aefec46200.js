angular.module("app").service("backgroundAService",function(){this.backgroundImg="",this.imageSrc=""}),angular.module("app").directive("backgroundbuttonDirective",["backgroundAService",function(){return{restrict:"E",replace:!0,scope:{openModal:"&",background:"@"},template:'<button id="backgroundButtonText" class="btn btn-default" background="" >{{backgroundText}}</button>',link:function(n,a,o){function r(){$("#saveMessage").text("Changes Made, Save Pending..."),$("#lefile").attr("value",""),$("#lefile").val(""),canvas.setBackgroundImage(0,canvas.renderAll.bind(canvas)),onSave()}function g(n){n?$("#backgroundButtonText").html("Remove Background"):$("#backgroundButtonText").html("Background")}n.backgroundText="Background",n.$watch(function(){a.attr("background")&&console.log("background changed")}),backgroundExists=function(n){log.info("In background exists:",n);var a=!1;return void 0===n||""===n?(a=!1,log.debug("Using Background Button"),backgroundText="Background"):(a=!0,log.debug("Using Remove Background Button"),backgroundText="Remove Background"),log.info("Leaving Background Exists"),a},backgroundModal=function(){log.info("Entering backgroundModal"),log.infog(n.openModal),n.openModal(),log.info("Leaving backgroundModal")},runBackground=function(){log.info("In Run Background"),$("#lefile").value="",$("#backgroundfile").val("");var n=$("#bar");return n.addClass("progress-success"),n.text("0%"),n.attr("value","0"),!1},$(window).load(function(){backgroundImageVal="",null!==canvas.backgroundImage&&(backgroundimg=canvas.backgroundImage,log.info("drawing_scripts: ",backgroundimg),null!==backgroundimg.src&&(backgroundImageVal=canvas.backgroundImage.src)),$("#backgroundButtonText").attr("background",backgroundImageVal),log.info("In link background val: ",a.attr("background")),backgroundExists(a.attr("background"))}),a.bind("click",function(){return log.info("background val: ",a.attr("background")),""==a.attr("background")?(runBackground(),backgroundModal(),g(!0),!1):(r(),g(!1),o.$set("background",""),!1)})}}}]);
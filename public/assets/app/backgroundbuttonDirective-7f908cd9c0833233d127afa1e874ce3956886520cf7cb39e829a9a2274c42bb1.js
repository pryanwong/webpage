angular.module("app").service("backgroundAService",function(){this.backgroundImg="",this.imageSrc=""}),angular.module("app").directive("backgroundbuttonDirective",["backgroundAService",function(){return{restrict:"E",replace:!0,scope:{background:"@"},template:'<button id="backgroundButtonText" class="btn btn-default" background="" >Background</button>',link:function(n,a,o){function r(){$("#saveMessage").text("Changes Made, Save Pending..."),$("#lefile").attr("value",""),$("#lefile").val(""),canvas.setBackgroundImage(0,canvas.renderAll.bind(canvas)),onSave()}function c(n){n?$("#backgroundButtonText").html("Remove Background"):$("#backgroundButtonText").html("Background")}n.$watch(function(){a.attr("background")&&console.log("background changed")}),backgroundExists=function(n){log.info("In background exists"),console.log("In background exists:",n);var a=!1;return void 0===n||""===n?(a=!1,log.debug("Using Background Button"),$("#backgroundButtonText").html("Background")):(a=!0,log.debug("Using Remove Background Button"),$("#backgroundButtonText").html("Remove Background")),log.info("Leaving Background Exists"),a},backgroundModal=function(){log.info("Entering backgroundModal"),$("#backgroundSection").modal("show"),log.info("Leaving backgroundModal")},runBackground=function(){return console.log("In Run Background"),$("#lefile").value="",$("#backgroundfile").val(""),progressBar.addClass("progress-success"),progressBar.text("0%"),progressBar.attr("value","0"),backgroundModal(),!1},$(window).load(function(){backgroundImageVal="",null!==canvas.backgroundImage&&(backgroundimg=canvas.backgroundImage,console.log("drawing_scripts: ",backgroundimg),null!==backgroundimg.src&&(backgroundImageVal=canvas.backgroundImage.src)),$("#backgroundButtonText").attr("background",backgroundImageVal),console.log("In link background val: ",a.attr("background")),backgroundExists(a.attr("background"))}),a.bind("click",function(){return console.log("background val: ",a.attr("background")),""==a.attr("background")?(runBackground(),backgroundModal(),c(!0),!1):(r(),c(!1),o.$set("background",""),!1)})}}}]);